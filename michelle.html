<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cl√≠nica Serenity - Gest√£o Completa</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-soft: #f4f7f6;
            --mint: #e8f5e9;
            --mint-dark: #81c784;
            --lavender: #f3e5f5;
            --lavender-dark: #ba68c8;
            --peach: #fff3e0;
            --text: #455a64;
            --white: #ffffff;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: var(--bg-soft);
            color: var(--text);
            margin: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Nav */
        nav {
            background: var(--white);
            padding: 15px;
            display: flex;
            justify-content: center;
            gap: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        nav button {
            padding: 10px 20px;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 500;
            border-radius: 20px;
            color: var(--text);
            transition: 0.3s;
        }

        nav button.active { background: var(--mint); color: var(--mint-dark); font-weight: 700; }

        /* Screens */
        .screen { display: none; padding: 30px; flex: 1; }
        .screen.active { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .container { max-width: 1000px; margin: 0 auto; }
        .card { background: var(--white); padding: 30px; border-radius: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.02); }

        /* Form Grid */
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .full-width { grid-column: span 2; }

        input, select, textarea {
            width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd;
            font-family: inherit; margin-top: 5px; box-sizing: border-box;
        }

        button.btn-save {
            background: var(--mint-dark); color: white; border: none; padding: 15px;
            width: 100%; border-radius: 10px; cursor: pointer; font-weight: 700; margin-top: 20px;
        }

        /* Timeline Agenda */
        .date-picker { text-align: center; margin-bottom: 20px; font-size: 1.2rem; }
        .date-picker input { width: auto; font-weight: bold; border-color: var(--mint-dark); }

        .timeline-item {
            display: flex; align-items: center; background: white; margin-bottom: 8px;
            padding: 15px 25px; border-radius: 15px; border-left: 5px solid #eee;
        }

        .timeline-item.occupied { border-left-color: var(--lavender-dark); background: var(--lavender); }
        .timeline-item.free { border-left-color: var(--mint-dark); color: #999; }

        .time-slot { font-weight: 700; width: 80px; font-size: 1.1rem; }
        .patient-name { flex: 1; font-weight: 500; }
        .actions { display: flex; gap: 10px; }

        .btn-confirm { background: #81c784; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; }
        .btn-cancel { background: #ef5350; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; }

        /* Cr√©ditos */
        footer {
            text-align: center;
            padding: 20px;
            font-size: 0.9rem;
            color: #90a4ae;
            opacity: 0.8;
        }
        footer strong { color: var(--mint-dark); }
    </style>
</head>
<body>

    <nav>
        <button onclick="showScreen('screen-agenda')" id="nav-agenda" class="active">üìÖ Agenda do Dia</button>
        <button onclick="showScreen('screen-cadastro')" id="nav-cadastro">üë§ Novo Paciente</button>
        <button onclick="showScreen('screen-marcar')" id="nav-marcar">‚úèÔ∏è Marcar Consulta</button>
        <button onclick="showScreen('screen-prontuario')" id="nav-prontuario">üìù Prontu√°rio</button>
    </nav>

    <section id="screen-agenda" class="screen active">
        <div class="container">
            <div class="date-picker">
                Visualizando dia: <input type="date" id="filtro-data" onchange="renderTimeline()">
            </div>
            <div id="timeline-container">
                </div>
        </div>
    </section>

    <section id="screen-cadastro" class="screen">
        <div class="container">
            <div class="card">
                <h2>Cadastro de Paciente</h2>
                <div class="form-grid">
                    <div class="form-group full-width">
                        <label>Nome Completo</label>
                        <input type="text" id="c-nome">
                    </div>
                    <div class="form-group">
                        <label>E-mail</label>
                        <input type="email" id="c-email">
                    </div>
                    <div class="form-group">
                        <label>Sexo</label>
                        <select id="c-sexo">
                            <option value="Feminino">Feminino</option>
                            <option value="Masculino">Masculino</option>
                            <option value="Outro">Outro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Idade</label>
                        <input type="number" id="c-idade">
                    </div>
                    <div class="form-group">
                        <label>Telefone</label>
                        <input type="text" id="c-tel">
                    </div>
                    <div class="form-group full-width">
                        <label>Endere√ßo</label>
                        <input type="text" id="c-end">
                    </div>
                </div>
                <button class="btn-save" onclick="salvarPaciente()">Cadastrar Paciente</button>
            </div>
        </div>
    </section>

    <section id="screen-marcar" class="screen">
        <div class="container">
            <div class="card" style="background: var(--peach);">
                <h2>Novo Agendamento</h2>
                <label>Selecione o Paciente</label>
                <select id="sel-paciente"></select>
                <label style="display:block; margin-top:15px;">Data e Hora</label>
                <input type="datetime-local" id="ag-data-hora">
                <button class="btn-save" style="background: #ffa726;" onclick="agendar()">Agendar Consulta</button>
            </div>
        </div>
    </section>

    <section id="screen-prontuario" class="screen">
        <div class="container">
            <div class="card">
                <h2>Evolu√ß√£o Cl√≠nica</h2>
                <select id="sel-paciente-pr"></select>
                <textarea id="pr-relato" rows="10" placeholder="Digite aqui o hist√≥rico da sess√£o..."></textarea>
                <button class="btn-save" style="background: var(--lavender-dark);" onclick="salvarProntuario()">Salvar no Prontu√°rio</button>
            </div>
        </div>
    </section>

    <footer>
        Desenvolvido por <strong>Carlos Almeida</strong> &copy; 2026
    </footer>

    <script>
        let pacientes = JSON.parse(localStorage.getItem('db_pacientes')) || [];
        let consultas = JSON.parse(localStorage.getItem('db_consultas')) || [];

        document.getElementById('filtro-data').valueAsDate = new Date();

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.getElementById('nav-' + id.split('-')[1]).classList.add('active');
            
            if(id === 'screen-agenda') renderTimeline();
            popularSelects();
        }

        function popularSelects() {
            const sels = [document.getElementById('sel-paciente'), document.getElementById('sel-paciente-pr')];
            sels.forEach(s => {
                s.innerHTML = '<option value="">--- Selecione ---</option>';
                pacientes.forEach((p, i) => s.innerHTML += `<option value="${i}">${p.nome}</option>`);
            });
        }

        function salvarPaciente() {
            const p = {
                nome: document.getElementById('c-nome').value,
                email: document.getElementById('c-email').value,
                sexo: document.getElementById('c-sexo').value,
                idade: document.getElementById('c-idade').value,
                tel: document.getElementById('c-tel').value,
                end: document.getElementById('c-end').value
            };
            if(!p.nome) return alert("Nome √© obrigat√≥rio");
            pacientes.push(p);
            localStorage.setItem('db_pacientes', JSON.stringify(pacientes));
            alert("Paciente salvo!");
            showScreen('screen-agenda');
        }

        function agendar() {
            const pIdx = document.getElementById('sel-paciente').value;
            const dataHora = document.getElementById('ag-data-hora').value;
            if(pIdx === "" || !dataHora) return alert("Preencha tudo");

            consultas.push({
                paciente: pacientes[pIdx].nome,
                data: dataHora,
                status: 'Confirmado'
            });
            localStorage.setItem('db_consultas', JSON.stringify(consultas));
            alert("Agendado!");
            renderTimeline();
            showScreen('screen-agenda');
        }

        function renderTimeline() {
            const container = document.getElementById('timeline-container');
            const dataFiltro = document.getElementById('filtro-data').value;
            container.innerHTML = "";

            for(let h = 8; h <= 18; h++) {
                const horaStr = h.toString().padStart(2, '0') + ":00";
                const agendado = consultas.find(c => {
                    const cData = c.data.split('T')[0];
                    const cHora = c.data.split('T')[1]?.substring(0, 5);
                    return cData === dataFiltro && cHora === horaStr;
                });

                if(agendado) {
                    container.innerHTML += `
                        <div class="timeline-item occupied">
                            <div class="time-slot">${horaStr}</div>
                            <div class="patient-name">${agendado.paciente}</div>
                            <div class="actions">
                                <button class="btn-confirm">‚úì</button>
                                <button class="btn-cancel" onclick="cancelarConsulta('${agendado.data}')">‚úï</button>
                            </div>
                        </div>
                    `;
                } else {
                    container.innerHTML += `
                        <div class="timeline-item free">
                            <div class="time-slot">${horaStr}</div>
                            <div class="patient-name">Livre</div>
                        </div>
                    `;
                }
            }
        }

        function cancelarConsulta(dataHora) {
            if(confirm("Deseja cancelar esta consulta?")) {
                consultas = consultas.filter(c => c.data !== dataHora);
                localStorage.setItem('db_consultas', JSON.stringify(consultas));
                renderTimeline();
            }
        }

        function salvarProntuario() {
            alert("Prontu√°rio salvo localmente com sucesso!");
            document.getElementById('pr-relato').value = "";
        }

        renderTimeline();
        popularSelects();
    </script>
</body>
</html>